% ============================================================================
%  RSPZ document: основной файл для компиляции документа "Расширенное
%  содержание пояснительной записки".
% ============================================================================
% arara: xelatex
% arara: biber
% arara: xelatex: { synctex: true }

\documentclass[12pt,a4paper,oneside,final]{report}

% --- Подключение шаблона ----------------------------------------------------
\input{template/preamble/thesis-template-macro}

% --- Настройки для РСПЗ ------------------------------------------------------
% В РСПЗ мы показываем аннотации разделов и подразделов
\showannotationstrue

% --- Подключение содержимого задания ---------------------------------------
% Необходимо для включения листа задания в документ
\input{content/1-main-content/1-task-content}

\begin{document}

% --- Титульный лист РСПЗ ----------------------------------------------------
% Условная вставка: либо готовый PDF, либо LaTeX-верстка
\ifusepdfRspzTitle
    \includepdf[pages={-}, offset=0mm -0mm]{\rspztitlepdf}
\else
    \input{template/titles/2-rspz-title}
\fi
\newpage

% --- Лист задания -----------------------------------------------------------
% Условная вставка: либо готовый PDF, либо LaTeX-верстка
\ifusepdfTaskSheet
    \includepdf[pages={-}, offset=0mm -0mm]{\tasktitlepdf}
\else
    \input{template/titles/1-task-title}
\fi
\newpage

% --- Настройка нумерации страниц --------------------------------------------
\pagestyle{plain}
\pagenumbering{arabic}
\setcounter{page}{2}

% --- Основное содержимое документа -------------------------------------------
% Используется отдельная refsection для изоляции библиографии РСПЗ
\refsection

\clearpage

\input{content/1-main-content/2-abstract}

\clearpage

\input{content/1-main-content/3-toc}

\clearpage

\input{content/1-main-content/4-intro}

\clearpage

\input{content/1-main-content/5-chapter-1}

\clearpage

\input{content/1-main-content/6-chapter-2}

\clearpage

\input{content/1-main-content/7-chapter-3}

\clearpage

\input{content/1-main-content/8-conclusion}

% --- Подсчет общих счетчиков для реферата -----------------------------------
% Сохраняем значения счетчиков перед библиографией для использования в реферате
\setcounter{totalfigures}{\the\value{totalfigures}+\the\value{figure}}
\setcounter{figure}{0}
\setcounter{totaltables}{\the\value{totaltables}+\the\value{table}}
\setcounter{table}{0}
\setcounter{totallistings}{\the\value{totallistings}+\the\value{lstlisting}}
\setcounter{lstlisting}{0}

% Создаем метки для ссылок на общее количество фигур, таблиц и листингов
\makeatletter
\edef\@currentlabel{\the\value{totalfigures}}
\label{figures}
\edef\@currentlabel{\the\value{totaltables}}
\label{tables}
\edef\@currentlabel{\the\value{totallistings}}
\label{listings}
\makeatother

% --- Список использованной литературы ----------------------------------------
\clearpage

\input{content/1-main-content/9-bibliography}

\endrefsection

\label{end_of_main_text}

\label{end_of_document}

\end{document}
